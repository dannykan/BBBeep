# UBeep Mobile App - UI/UX Flow Documentation

## Overview

UBeep is a one-way anonymous message reminder system for drivers. Users send caring reminders to other drivers via license plates.

---

## Navigation Architecture

```
RootNavigator
├── AuthNavigator (未登入)
│   ├── LandingScreen
│   ├── LoginScreen
│   └── VerifyCodeScreen
│
├── OnboardingNavigator (已登入，未完成註冊)
│   ├── UserTypeScreen
│   ├── LicensePlateScreen
│   ├── NicknameScreen
│   ├── PointsExplanationScreen
│   ├── InviteCodeScreen
│   └── WelcomeScreen
│
└── MainNavigator + Root Stack (已登入且已完成註冊)
    ├── Bottom Tabs
    │   ├── Home (首頁)
    │   ├── Send (發送) → SendNavigator
    │   ├── Inbox (訊息) → InboxNavigator
    │   ├── Wallet (點數)
    │   └── Settings (設定)
    │
    └── Root Stack Screens (從任何頁面可訪問)
        ├── Wallet
        ├── Sent (發送紀錄)
        ├── InviteFriends (邀請好友)
        ├── BlockList (封鎖名單)
        ├── EditProfile (編輯個人資料)
        ├── LicensePlateChange (變更車牌)
        ├── NotificationSettings (通知設定)
        ├── Appearance (外觀)
        ├── Legal (法律條款)
        ├── QuickRecord (快速錄音)
        └── Drafts (語音草稿)
```

---

## 1. Authentication Flow (認證流程)

### 1.1 LandingScreen (歡迎頁)
**路徑:** `/auth/landing`

| 元素 | 功能 | 導航目標 |
|------|------|---------|
| 「登入」按鈕 | 進入登入頁面 | → LoginScreen |
| 功能介紹卡片 | 顯示 App 特色 | - |
| 試用期說明 | 7 天試用期 50 點 | - |

### 1.2 LoginScreen (登入頁)
**路徑:** `/auth/login`

| 元素 | 功能 | 導航目標 |
|------|------|---------|
| Apple 登入按鈕 | Apple Sign In | → Main/Onboarding |
| LINE 登入按鈕 | LINE Login | → Main/Onboarding |
| 「使用車牌登入」按鈕 | 切換到車牌登入模式 | - |
| 車牌輸入欄 | 輸入車牌號碼 | - |
| 密碼輸入欄 | 輸入密碼 | - |
| 「登入」按鈕 | 車牌密碼登入 | → Main/Onboarding |
| ← 返回 | 返回歡迎頁 | → LandingScreen |

**彈出對話框:**
| 觸發條件 | 標題 | 內容 |
|---------|------|------|
| Apple 登入失敗 | 登入失敗 | Apple 登入失敗，請稍後再試 |
| LINE 登入失敗 | 登入失敗 | LINE 登入失敗，請稍後再試 |
| 車牌為空 | - | 請輸入車牌號碼 |
| 密碼為空 | - | 請輸入密碼 |
| 車牌登入失敗 | 登入失敗 | 車牌或密碼錯誤 |

### 1.3 VerifyCodeScreen (驗證碼頁)
**路徑:** `/auth/verify`

| 元素 | 功能 | 導航目標 |
|------|------|---------|
| 6 位數驗證碼輸入 | 輸入 OTP | - |
| 「驗證」按鈕 | 提交驗證碼 | → Main/Onboarding |
| 「重新發送」按鈕 | 重發驗證碼 | - |
| 倒數計時器 | 顯示重發等待時間 | - |

**彈出對話框:**
| 觸發條件 | 標題 | 內容 |
|---------|------|------|
| 驗證碼不足 6 位 | 錯誤 | 請輸入 6 位驗證碼 |
| 驗證失敗 | 錯誤 | 驗證失敗 |
| 重發成功 | 成功 | 驗證碼已重新發送 |
| 重發失敗 | 錯誤 | 重新發送失敗 |

---

## 2. Onboarding Flow (新手引導流程)

### 2.1 UserTypeScreen (用戶類型)
**路徑:** `/onboarding/user-type`

| 元素 | 功能 | 導航目標 |
|------|------|---------|
| 「車主」選項 | 選擇車主身份 | → LicensePlateScreen |
| 「騎士」選項 | 選擇機車騎士身份 | → LicensePlateScreen |
| 「行人」選項 | 選擇行人身份 | → NicknameScreen |

### 2.2 LicensePlateScreen (車牌登記)
**路徑:** `/onboarding/license-plate`

| 元素 | 功能 | 導航目標 |
|------|------|---------|
| 車牌輸入欄 | 輸入車牌號碼 | - |
| 「上傳行照」按鈕 | 上傳車牌證明照片 | - |
| 「下一步」按鈕 | 驗證並繼續 | → NicknameScreen |
| ← 返回 | 返回上一步 | → UserTypeScreen |

**彈出對話框 (Modal):**
| 名稱 | 觸發條件 | 內容 |
|------|---------|------|
| 車牌已被登記 Modal | 車牌已有其他用戶 | 選擇：提交申請 / 更換車牌 |
| 提交申請 Modal | 點擊「提交申請」 | Email 輸入 + 上傳行照 |
| 申請待審核 Modal | 申請成功提交 | 顯示審核中狀態 |

**彈出對話框 (Alert):**
| 觸發條件 | 標題 | 內容 |
|---------|------|------|
| 車牌格式錯誤 | 錯誤 | 車牌號碼格式無效 |
| 檢查車牌失敗 | 錯誤 | 檢查車牌失敗 |
| 相簿權限未授權 | 需要權限 | 請允許存取相簿以上傳行照照片 |
| 圖片上傳失敗 | 上傳失敗 | 圖片上傳失敗，請重試 |

### 2.3 NicknameScreen (暱稱設定)
**路徑:** `/onboarding/nickname`

| 元素 | 功能 | 導航目標 |
|------|------|---------|
| 暱稱輸入欄 | 輸入暱稱 (選填) | - |
| 「下一步」按鈕 | 繼續 | → PointsExplanationScreen |
| ← 返回 | 返回上一步 | → LicensePlateScreen |

### 2.4 PointsExplanationScreen (點數說明)
**路徑:** `/onboarding/points-explanation`

| 元素 | 功能 | 導航目標 |
|------|------|---------|
| 點數說明卡片 | 顯示各項點數消耗 | - |
| 「下一步」按鈕 | 繼續 | → InviteCodeScreen |
| ← 返回 | 返回上一步 | → NicknameScreen |

### 2.5 InviteCodeScreen (邀請碼)
**路徑:** `/onboarding/invite-code`

| 元素 | 功能 | 導航目標 |
|------|------|---------|
| 邀請碼輸入欄 | 輸入好友邀請碼 (選填) | - |
| 「使用邀請碼」按鈕 | 套用邀請碼 | - |
| 「跳過」按鈕 | 不使用邀請碼 | → WelcomeScreen |
| ← 返回 | 返回上一步 | → PointsExplanationScreen |

**彈出對話框:**
| 觸發條件 | 標題 | 內容 |
|---------|------|------|
| 邀請碼成功 | 成功 | 邀請碼已套用！完成註冊後你和邀請人各得 10 點 |
| 邀請碼失敗 | 錯誤 | 使用邀請碼失敗 |

### 2.6 WelcomeScreen (歡迎完成)
**路徑:** `/onboarding/welcome`

| 元素 | 功能 | 導航目標 |
|------|------|---------|
| 歡迎訊息 | 顯示完成註冊 | - |
| 「開始使用」按鈕 | 完成註冊流程 | → MainNavigator |

**彈出對話框:**
| 觸發條件 | 標題 | 內容 |
|---------|------|------|
| 車牌格式錯誤 | 錯誤 | 車牌號碼格式無效 |
| 完成註冊失敗 | 錯誤 | 完成註冊失敗 |

---

## 3. Main Tabs (主要頁籤)

### 3.1 HomeScreen (首頁)
**路徑:** `/main/home`

| 元素 | 功能 | 導航目標 |
|------|------|---------|
| 設定按鈕 (右上) | 進入設定頁 | → SettingsScreen |
| 點數顯示 | 顯示目前點數 | → WalletScreen |
| 「手動輸入」按鈕 | 發送提醒 (手動) | → SendNavigator |
| 「語音錄製」按鈕 | 快速語音錄製 | → QuickRecordScreen |
| 收件匣快捷 | 查看收到的訊息 | → InboxNavigator |
| 發送紀錄快捷 | 查看發送紀錄 | → SentScreen |
| 語音草稿快捷 | 查看語音草稿 | → DraftsScreen |
| 邀請好友卡片 | 複製/分享邀請碼 | - |
| 「點數不足」橫幅 | 點數低於 5 時顯示 | → WalletScreen |

**彈出對話框:**
| 觸發條件 | 標題 | 內容 | 按鈕 |
|---------|------|------|------|
| 複製邀請碼 | 已複製 | 邀請碼 XXX 已複製到剪貼簿 | 確定 |
| 麥克風權限被拒 | 需要麥克風權限 | 請前往「設定」→「UBeep」→ 開啟「麥克風」權限 | 取消 / 前往設定 |
| 麥克風權限檢查失敗 | 錯誤 | 無法檢查麥克風權限 | - |

---

### 3.2 Send Flow (發送流程) - V2

#### 3.2.1 PlateInputScreenV2 (輸入車牌)
**路徑:** `/send/plate-input`

| 元素 | 功能 | 導航目標 |
|------|------|---------|
| 車牌輸入欄 | 輸入目標車牌 | - |
| 最近車牌列表 | 快速選擇最近發送的車牌 | - |
| 車種自動偵測 | 根據車牌格式判斷車種 | - |
| 「下一步」按鈕 | 確認車牌並繼續 | → CategoryScreenV2 |

**彈出對話框:**
| 觸發條件 | 標題 | 內容 |
|---------|------|------|
| 車牌格式錯誤 | 錯誤 | 請輸入正確的車牌格式 |

#### 3.2.2 CategoryScreenV2 (選擇類別)
**路徑:** `/send/category`

| 元素 | 功能 | 導航目標 |
|------|------|---------|
| 車況提醒 | 選擇車況類別 | → MessageEditScreen |
| 行車安全 | 選擇安全類別 | → MessageEditScreen |
| 讚美感謝 | 選擇讚美類別 | → MessageEditScreen |
| 其他 | 選擇其他類別 | → MessageEditScreen |
| ← 返回 | 返回車牌輸入 | → PlateInputScreenV2 |

#### 3.2.3 MessageEditScreen (編輯訊息)
**路徑:** `/send/message-edit`

| 元素 | 功能 | 導航目標 |
|------|------|---------|
| 情境選擇區 | 選擇預設情境 (自動填入模板) | - |
| 訊息輸入區 | 輸入/編輯訊息文字 | - |
| 字數計數器 | 顯示 5-100 字限制 | - |
| 錄音按鈕 | 開始/停止錄音 | - |
| 播放按鈕 | 播放錄音 | - |
| 「AI 優化」按鈕 | AI 改寫訊息 | - |
| 「下一步」按鈕 | 確認訊息繼續 | → ConfirmScreenV2 |
| ← 返回 | 返回類別選擇 | → CategoryScreenV2 |

**彈出對話框:**
| 觸發條件 | 標題 | 內容 |
|---------|------|------|
| 麥克風權限被拒 | 需要麥克風權限 | 請前往「設定」→「UBeep」→ 開啟「麥克風」權限 |
| 麥克風權限檢查失敗 | 錯誤 | 無法檢查麥克風權限 |
| 無法開始錄音 | 錯誤 | 無法開始錄音，請稍後再試 |
| 語音轉文字失敗 | 轉文字失敗 | 語音轉文字失敗，請手動輸入或重新錄音 |
| 無法播放錄音 | 錯誤 | 無法播放錄音 |
| 訊息太短 | 訊息太短 | 請至少輸入 5 個字 |
| 內容不當 | 內容不當 | 請修改內容後再試 |
| AI 優化失敗 | 優化失敗 | AI 優化失敗，請稍後再試或使用文字發送 |

#### 3.2.4 ConfirmScreenV2 (確認發送)
**路徑:** `/send/confirm`

| 元素 | 功能 | 導航目標 |
|------|------|---------|
| 訊息預覽 | 顯示完整訊息內容 | - |
| 語音播放器 | 播放語音訊息 (如有) | - |
| 地點輸入欄 | 輸入/編輯事發地點 | - |
| 「選擇地點」按鈕 | 開啟地圖選擇器 | → MapLocationPicker Modal |
| 「目前位置」按鈕 | 自動填入目前位置 | - |
| 時間選擇區 | 選擇事發時間 | - |
| 「現在」按鈕 | 設為現在 | - |
| 「5 分鐘前」按鈕 | 設為 5 分鐘前 | - |
| 「10 分鐘前」按鈕 | 設為 10 分鐘前 | - |
| 「自訂時間」按鈕 | 開啟時間選擇器 | → DateTimePicker Modal |
| 點數消耗顯示 | 顯示此次發送消耗點數 | - |
| 「發送」按鈕 | 確認發送訊息 | → SuccessScreen |
| ← 返回 | 返回訊息編輯 | → MessageEditScreen |

**彈出對話框:**
| 觸發條件 | 標題 | 內容 | 按鈕 |
|---------|------|------|------|
| 點數不足 | 點數不足 | 請先儲值 | 取消 / 去儲值 |
| 未完成步驟 | 錯誤 | 請完成所有步驟 | - |
| 未填寫地點 | 請填寫地點 | 需要事發地點才能發送提醒 | - |
| 內容不當 | 內容不當 | 請修改內容後再試 | - |
| 車牌格式錯誤 | 錯誤 | 車牌號碼格式無效 | - |
| 語音上傳失敗 | 錯誤 | 上傳語音失敗 | - |
| 發送失敗 | 錯誤 | 發送失敗 | - |
| 位置權限被拒 | 需要位置權限 | 請前往設定開啟位置權限 | 取消 / 前往設定 |
| 無法取得位置 | 錯誤 | 無法取得目前位置 | - |

**Modal 對話框:**
| 名稱 | 功能 |
|------|------|
| MapLocationPicker | 地圖選擇事發地點 |
| DateTimePicker | 自訂時間選擇器 (日期/時/分) |

#### 3.2.5 SuccessScreen (發送成功)
**路徑:** `/send/success`

| 元素 | 功能 | 導航目標 |
|------|------|---------|
| 成功動畫 | 愛心圖示動畫 | - |
| 目標車牌顯示 | 顯示發送對象 | - |
| 推播通知說明 | 說明對方會收到通知 | - |
| 「回首頁」按鈕 | 返回首頁 | → HomeScreen |
| 「再發一則」按鈕 | 重新發送 | → PlateInputScreenV2 |
| 「分享」按鈕 | 分享至社群 | 系統分享面板 |

---

### 3.3 InboxNavigator (收件匣)

#### 3.3.1 InboxListScreen (訊息列表)
**路徑:** `/inbox/list`

| 元素 | 功能 | 導航目標 |
|------|------|---------|
| 訊息卡片 | 顯示收到的訊息 | → MessageDetailScreen |
| 未讀標記 | 藍點顯示未讀 | - |
| 類別標籤 | 顯示訊息類別 | - |
| 重新整理 | 下拉刷新 | - |

**彈出對話框:**
| 觸發條件 | 標題 | 內容 |
|---------|------|------|
| 載入失敗 | 錯誤 | 載入失敗 |

#### 3.3.2 MessageDetailScreen (訊息詳情)
**路徑:** `/inbox/detail/:messageId`

| 元素 | 功能 | 導航目標 |
|------|------|---------|
| 訊息內容 | 顯示完整訊息 | - |
| 發送者資訊 | 顯示車種、暱稱 | - |
| 地點/時間 | 顯示事發地點與時間 | - |
| 「快速回覆」按鈕 | 預設感謝回覆 | - |
| 回覆輸入欄 | 自訂回覆文字 | - |
| 「AI 改寫」按鈕 | AI 優化回覆 | - |
| 「封鎖」按鈕 | 封鎖發送者 | → Block Modal |
| 「檢舉」按鈕 | 檢舉訊息內容 | → Report Modal |
| ← 返回 | 返回訊息列表 | → InboxListScreen |

**Modal 對話框:**
| 名稱 | 功能 | 按鈕 |
|------|------|------|
| Block Modal | 確認封鎖用戶 | 取消 / 確認封鎖 |
| Report Modal | 輸入檢舉原因並提交 | 取消 / 提交檢舉 |

**彈出對話框:**
| 觸發條件 | 標題 | 內容 |
|---------|------|------|
| 找不到訊息 | 錯誤 | 找不到此訊息 |
| 載入失敗 | 錯誤 | 載入失敗 |
| 回覆成功 | 成功 | 回覆已送出 |
| 回覆失敗 | 錯誤 | 回覆失敗 |
| AI 改寫失敗 | 錯誤 | AI 改寫失敗 |
| 點數不足 | 點數不足 | 需要 X 點才能送出回覆 |
| 封鎖成功 | 成功 | 已封鎖該用戶 |
| 封鎖失敗 | 錯誤 | 封鎖失敗 |
| 檢舉成功 | 成功 | 檢舉已提交，我們會儘快處理 |
| 檢舉失敗 | 錯誤 | 檢舉失敗 |

---

### 3.4 WalletScreen (點數錢包)
**路徑:** `/wallet`

| 元素 | 功能 | 導航目標 |
|------|------|---------|
| 點數餘額 | 顯示目前點數 | - |
| 10 點方案 | 購買 10 點 | IAP 流程 |
| 30 點方案 (熱門) | 購買 30 點 | IAP 流程 |
| 50 點方案 | 購買 50 點 | IAP 流程 |
| 100 點方案 | 購買 100 點 | IAP 流程 |
| 點數紀錄列表 | 顯示交易歷史 | - |
| ← 返回 | 返回上一頁 | 上一頁 |

**彈出對話框:**
| 觸發條件 | 標題 | 內容 |
|---------|------|------|
| 購買成功 | 購買成功 | 點數已加入您的帳戶！ |
| 購買失敗 | 購買失敗 | 請稍後再試 |
| IAP 服務暫時無法使用 | 提示 | 儲值服務暫時無法使用，請稍後再試 |
| 產品資訊載入中 | 提示 | 產品資訊載入中，請稍後再試 |

---

### 3.5 SettingsScreen (設定)
**路徑:** `/settings`

| 元素 | 功能 | 導航目標 |
|------|------|---------|
| 個人資料卡片 | 顯示暱稱/車牌 | → EditProfileScreen |
| 通知設定 | 推播通知設定 | → NotificationSettingsScreen |
| 外觀 | 深色/淺色模式 | → AppearanceScreen |
| 發送紀錄 | 查看發送的訊息 | → SentScreen |
| 點數 | 點數管理 | → WalletScreen |
| 邀請好友 | 邀請碼/分享 | → InviteFriendsScreen |
| 封鎖名單 | 管理封鎖用戶 | → BlockListScreen |
| 車牌變更 | 申請變更車牌 | → LicensePlateChangeScreen |
| 法律條款 | 隱私權/服務條款 | → LegalScreen |
| 問題回報 | 透過 LINE 聯繫 | 開啟 LINE App |
| 登出 | 登出帳號 | → Logout Alert |

**彈出對話框:**
| 觸發條件 | 標題 | 內容 | 按鈕 |
|---------|------|------|------|
| 點擊登出 | 登出 | 確定要登出嗎？ | 取消 / 登出 |
| LINE 未安裝 | 無法開啟 | 請確認已安裝 LINE App | - |

---

## 4. Root Stack Screens (全域畫面)

### 4.1 SentScreen (發送紀錄)
**路徑:** `/sent`

| 元素 | 功能 | 導航目標 |
|------|------|---------|
| 發送訊息列表 | 顯示已發送的訊息 | - |
| 訊息卡片展開 | 顯示完整內容 | - |
| 回覆標記 | 顯示對方是否已回覆 | - |
| ← 返回 | 返回設定頁 | → SettingsScreen |

**彈出對話框:**
| 觸發條件 | 標題 | 內容 |
|---------|------|------|
| 載入失敗 | 錯誤 | 載入發送記錄失敗 |

### 4.2 InviteFriendsScreen (邀請好友)
**路徑:** `/invite-friends`

| 元素 | 功能 | 導航目標 |
|------|------|---------|
| 邀請碼顯示 | 顯示您的邀請碼 | - |
| 「複製」按鈕 | 複製邀請碼 | - |
| 「分享」按鈕 | 分享邀請連結 | 系統分享面板 |
| 獎勵說明 | 雙方各得 10 點 | - |
| ← 返回 | 返回設定頁 | → SettingsScreen |

**彈出對話框:**
| 觸發條件 | 標題 | 內容 |
|---------|------|------|
| 複製邀請碼 | 邀請碼 | [邀請碼內容] |
| 複製連結 | 邀請連結 | [連結內容] |

### 4.3 BlockListScreen (封鎖名單)
**路徑:** `/block-list`

| 元素 | 功能 | 導航目標 |
|------|------|---------|
| 封鎖用戶列表 | 顯示已封鎖的用戶 | - |
| 「解除封鎖」按鈕 | 解除封鎖該用戶 | - |
| ← 返回 | 返回設定頁 | → SettingsScreen |

**彈出對話框:**
| 觸發條件 | 標題 | 內容 | 按鈕 |
|---------|------|------|------|
| 點擊解除封鎖 | 解除封鎖 | 確定要解除封鎖「XXX」嗎？ | 取消 / 解除封鎖 |
| 解除成功 | 成功 | 已解除封鎖 | - |
| 解除失敗 | 錯誤 | 解除封鎖失敗 | - |

### 4.4 EditProfileScreen (編輯個人資料)
**路徑:** `/edit-profile`

| 元素 | 功能 | 導航目標 |
|------|------|---------|
| 暱稱輸入欄 | 編輯暱稱 | - |
| 「儲存」按鈕 | 儲存變更 | → SettingsScreen |
| ← 返回 | 返回設定頁 | → SettingsScreen |

**彈出對話框:**
| 觸發條件 | 標題 | 內容 |
|---------|------|------|
| 暱稱過長 | 錯誤 | 暱稱最多 12 個字 |
| 更新成功 | 成功 | 個人資料已更新 |
| 更新失敗 | 錯誤 | 更新失敗 |

### 4.5 LicensePlateChangeScreen (變更車牌)
**路徑:** `/license-plate-change`

| 元素 | 功能 | 導航目標 |
|------|------|---------|
| 目前車牌顯示 | 顯示目前登記車牌 | - |
| 新車牌輸入欄 | 輸入新車牌 | - |
| 「上傳行照」按鈕 | 上傳證明照片 | → 選擇上傳方式 Alert |
| 「提交申請」按鈕 | 提交變更申請 | - |
| ← 返回 | 返回設定頁 | → SettingsScreen |

**彈出對話框:**
| 觸發條件 | 標題 | 內容 | 按鈕 |
|---------|------|------|------|
| 點擊上傳 | 上傳行照照片 | 請選擇上傳方式 | 從相簿選擇 / 拍照 / 取消 |
| 相簿權限不足 | 權限不足 | 需要相簿存取權限才能上傳行照照片 | - |
| 相機權限不足 | 權限不足 | 需要相機存取權限才能拍攝行照照片 | - |
| 圖片上傳失敗 | 上傳失敗 | 圖片上傳失敗，請稍後再試 | - |
| 未輸入車牌 | 錯誤 | 請輸入新的車牌號碼 | - |
| 車牌格式錯誤 | 錯誤 | 車牌號碼格式無效 | - |
| 車牌未變更 | 錯誤 | 新車牌與目前車牌相同 | - |
| 未上傳行照 | 錯誤 | 請上傳行照照片以驗證車牌所有權 | - |
| 申請成功 | 申請已送出 | 我們會在 1-2 個工作天內審核您的申請 | 確定 |
| 申請失敗 | 錯誤 | 提交申請失敗 | - |

### 4.6 NotificationSettingsScreen (通知設定)
**路徑:** `/notification-settings`

| 元素 | 功能 | 導航目標 |
|------|------|---------|
| 推播通知開關 | 開啟/關閉推播 | - |
| ← 返回 | 返回設定頁 | → SettingsScreen |

### 4.7 AppearanceScreen (外觀設定)
**路徑:** `/appearance`

| 元素 | 功能 | 導航目標 |
|------|------|---------|
| 淺色模式 | 選擇淺色主題 | - |
| 深色模式 | 選擇深色主題 | - |
| 跟隨系統 | 跟隨系統設定 | - |
| ← 返回 | 返回設定頁 | → SettingsScreen |

### 4.8 LegalScreen (法律條款)
**路徑:** `/legal/:type`

| 元素 | 功能 | 導航目標 |
|------|------|---------|
| 服務條款內容 | 顯示服務條款 (type=terms) | - |
| 隱私權政策內容 | 顯示隱私權政策 (type=privacy) | - |
| ← 返回 | 返回設定頁 | → SettingsScreen |

### 4.9 QuickRecordScreen (快速錄音)
**路徑:** `/quick-record`

| 元素 | 功能 | 導航目標 |
|------|------|---------|
| 錄音按鈕 | 開始/停止錄音 | - |
| 錄音時間顯示 | 顯示已錄製時間 (最長 15 秒) | - |
| 播放按鈕 | 播放錄音 | - |
| 「儲存草稿」按鈕 | 儲存為語音草稿 | → HomeScreen |
| ← 取消 | 取消錄音 | → HomeScreen |

**彈出對話框:**
| 觸發條件 | 標題 | 內容 |
|---------|------|------|
| 錄音太短 | 錄音太短 | 請至少錄製 1 秒 |
| 錄音失敗 | 錯誤 | 錄音失敗 |
| 無法開始錄音 | 錯誤 | 無法開始錄音 |
| 儲存失敗 | 儲存失敗 | 請稍後再試 |

### 4.10 DraftsScreen (語音草稿)
**路徑:** `/drafts`

| 元素 | 功能 | 導航目標 |
|------|------|---------|
| 草稿列表 | 顯示語音草稿 | - |
| 語音播放器 | 播放草稿語音 | - |
| 轉錄文字顯示 | 顯示語音轉文字結果 | - |
| 地點顯示 | 顯示錄音時位置 | - |
| 24 小時倒數 | 顯示草稿剩餘時間 | - |
| 「繼續編輯」按鈕 | 進入發送流程 | → SendNavigator |
| 「刪除」按鈕 | 刪除草稿 | → 刪除確認 Alert |
| ← 返回 | 返回首頁 | → HomeScreen |

**彈出對話框:**
| 觸發條件 | 標題 | 內容 | 按鈕 |
|---------|------|------|------|
| 點擊刪除 | 刪除草稿 | 確定要刪除這個草稿嗎？ | 取消 / 刪除 |
| 刪除失敗 | 錯誤 | [錯誤訊息] | - |

---

## 5. Modal Components (Modal 元件)

### 5.1 MapLocationPicker (地圖選擇器)
**來源:** `ConfirmScreenV2` 點擊「選擇地點」

| 元素 | 功能 |
|------|------|
| 地圖顯示 | iOS: Apple Maps / Android: Google Maps |
| 地址搜尋欄 | 輸入地址搜尋 (Google Geocoding API) |
| 搜尋結果列表 | 顯示地址建議 |
| 目前位置按鈕 | GPS 定位 |
| 地圖標記 | 點擊/拖曳標記選擇位置 |
| 「確認」按鈕 | 確認選擇 |
| 「取消」按鈕 | 取消選擇 |

**彈出對話框:**
| 觸發條件 | 標題 | 內容 | 按鈕 |
|---------|------|------|------|
| 位置權限被拒 | 需要位置權限 | 請前往「設定」→「UBeep」→ 開啟「位置」權限 | 取消 / 前往設定 |
| 無法取得位置 | 錯誤 | 無法取得目前位置 | - |
| 找不到地址 | 找不到地址 | 請嘗試不同的搜尋關鍵字 | - |
| 搜尋失敗 | 搜尋失敗 | 請稍後再試 | - |

### 5.2 DateTimePicker (時間選擇器)
**來源:** `ConfirmScreenV2` 點擊「自訂時間」

| 元素 | 功能 |
|------|------|
| 日期滾輪 | 選擇日期 (今天/昨天) |
| 小時滾輪 | 選擇小時 (0-23) |
| 分鐘滾輪 | 選擇分鐘 (0-59) |
| 「確認」按鈕 | 確認選擇 |
| 「取消」按鈕 | 取消選擇 |

### 5.3 QuickRecordModal (快速錄音 Modal)
**來源:** 已棄用，改用 QuickRecordScreen

---

## 6. Context Providers (全域狀態)

| Context | 功能 |
|---------|------|
| AuthContext | 用戶認證狀態、JWT Token、登入/登出 |
| SendContext | 發送流程狀態、車牌/類別/訊息/位置/時間 |
| ThemeContext | 深色/淺色模式切換 |
| NotificationContext | 推播通知權限與處理 |
| DraftContext | 語音草稿管理 |
| UnreadContext | 未讀訊息數量 |
| UnreadReplyContext | 未讀回覆數量 |
| OnboardingContext | 新手引導流程狀態 |

---

## 7. 點數消耗規則

| 發送模式 | 類別 | 點數 |
|---------|------|------|
| 模板 (未編輯) | 讚美感謝 | **免費** |
| 模板 (未編輯) | 其他類別 | 1 點 |
| 文字 (AI 審核通過) | 任何類別 | 2 點 |
| 文字 (堅持原內容) | 任何類別 | 4 點 |
| AI 優化 | 任何類別 | 2 點 |
| 語音 | 任何類別 | 6 點 |

---

## 8. 權限請求流程

| 權限 | 觸發時機 | 被拒後行為 |
|------|---------|----------|
| 麥克風 | QuickRecord / MessageEdit 錄音 | Alert 引導至設定 |
| 位置 | ConfirmScreen 取得位置 / MapLocationPicker | Alert 引導至設定 |
| 相簿 | LicensePlateScreen / LicensePlateChangeScreen 上傳行照 | Alert 提示權限不足 |
| 相機 | LicensePlateChangeScreen 拍攝行照 | Alert 提示權限不足 |
| 推播通知 | WelcomeScreen 完成註冊時 | Alert 引導至設定 |

---

## 9. 顏色標記系統

| 類別 | 顏色 | 用途 |
|------|------|------|
| 車況提醒 | 藍色 (#4A6FA5) | 訊息類別標籤、圖示 |
| 行車安全 | 橘色 (#F59E0B) | 訊息類別標籤、圖示 |
| 讚美感謝 | 粉紅 (#EC4899) | 訊息類別標籤、圖示 |
| 其他 | 灰色 | 訊息類別標籤、圖示 |
| 未讀標記 | 藍色圓點 | 訊息列表未讀指示 |

---

## 10. 總畫面數量統計

| 分類 | 數量 | 畫面列表 |
|------|------|---------|
| 認證流程 | 3 | Landing, Login, VerifyCode |
| 新手引導 | 6 | UserType, LicensePlate, Nickname, PointsExplanation, InviteCode, Welcome |
| 主要頁籤 | 5 | Home, Send, Inbox, Wallet, Settings |
| 發送流程 (V2) | 5 | PlateInputV2, CategoryV2, MessageEdit, ConfirmV2, Success |
| 收件匣 | 2 | InboxList, MessageDetail |
| 全域畫面 | 10 | Wallet, Sent, InviteFriends, BlockList, EditProfile, LicensePlateChange, NotificationSettings, Appearance, Legal, QuickRecord, Drafts |
| Modal | 3 | MapLocationPicker, DateTimePicker, QuickRecordModal |
| **總計** | **34** | |
