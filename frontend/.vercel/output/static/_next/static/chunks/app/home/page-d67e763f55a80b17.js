(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[951],{4465:function(e,s,t){Promise.resolve().then(t.bind(t,1112))},1112:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return w}});var r=t(7821),a=t(8078),n=t(8504),d=t(3923),l=t(3842),i=t(8006),c=t(9198),o=t(7296),x=t(687),m=t(9775),u=t(6576);let h=(0,u.Z)("wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]);var p=t(9086),f=t(7737),b=t(3390);let j=(0,u.Z)("history",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);var g=t(2625),v=t(1475),N=t(1188);let y=a.memo(()=>{var e,s;let t=(0,n.useRouter)(),{user:u,messages:y,isLoading:w,refreshUser:k,refreshMessages:Z}=(0,d.q)();if((0,a.useEffect)(()=>{w||u?u&&!u.hasCompletedOnboarding&&t.push("/onboarding"):t.push("/login")},[u,w,t]),w||!u)return(0,r.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,r.jsx)("div",{className:"text-muted-foreground",children:"載入中..."})});let C=y.filter(e=>!e.read).length,W=(null!==(e=null==u?void 0:u.points)&&void 0!==e?e:0)<5,M=e=>{switch(e){case"車況提醒":return"border-l-[3px] border-l-accent-vehicle";case"行車安全提醒":return"border-l-[3px] border-l-accent-safety";case"讚美感謝":return"border-l-[3px] border-l-accent-praise";default:return""}},P=e=>{switch(e){case"車況提醒":return"bg-accent-vehicle/10 text-accent-vehicle";case"行車安全提醒":return"bg-accent-safety/10 text-accent-safety";case"讚美感謝":return"bg-accent-praise/10 text-accent-praise";default:return"bg-muted text-muted-foreground"}};return(0,r.jsxs)("div",{className:"min-h-screen bg-background pb-20",children:[(0,r.jsx)("div",{className:"bg-card border-b border-border",children:(0,r.jsxs)("div",{className:"max-w-md mx-auto px-6 py-4 flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(null==u?void 0:u.nickname)&&(0,r.jsx)("div",{className:"text-xs text-muted-foreground mb-0.5",children:"暱稱"}),(0,r.jsx)("div",{className:"text-lg font-medium text-foreground flex items-center gap-2",children:(null==u?void 0:u.userType)==="pedestrian"?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.Z,{className:"h-4 w-4"}),(null==u?void 0:u.nickname)||"行人用戶"]}):(0,r.jsxs)(r.Fragment,{children:[(null==u?void 0:u.vehicleType)==="car"?(0,r.jsx)(o.Z,{className:"h-4 w-4"}):(0,r.jsx)(x.Z,{className:"h-4 w-4"}),(null==u?void 0:u.nickname)?(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("span",{className:"text-sm",children:u.nickname}),(0,r.jsx)("span",{className:"text-xs text-muted-foreground font-mono",children:u.licensePlate?(0,N.uk)(u.licensePlate):""})]}):(null==u?void 0:u.licensePlate)?(0,N.uk)(u.licensePlate):""]})})]}),(0,r.jsx)("button",{onClick:()=>t.push("/settings"),className:"p-2 hover:bg-muted/50 rounded-lg transition-colors",children:(0,r.jsx)(m.Z,{className:"h-5 w-5 text-muted-foreground",strokeWidth:1.5})})]})}),(0,r.jsxs)("div",{className:"max-w-md mx-auto p-6 space-y-6",children:[(0,r.jsxs)(i.Zb,{className:"p-5 bg-card border-border shadow-none",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs text-muted-foreground mb-1.5",children:"剩餘點數"}),(0,r.jsx)("div",{className:"text-5xl font-bold text-foreground tabular-nums leading-none",children:(null==u?void 0:u.points)||0})]}),(0,r.jsxs)(l.z,{variant:"outline",size:"sm",onClick:()=>t.push("/wallet"),className:"h-9 px-3 border-border text-foreground hover:bg-muted/50 shadow-none flex items-center gap-1.5",children:[(0,r.jsx)(h,{className:"h-4 w-4",strokeWidth:1.5}),(0,r.jsx)("span",{className:"text-sm",children:"儲值"})]})]}),W&&(0,r.jsxs)("div",{className:"mt-4 pt-4 border-t border-border flex items-start gap-2",children:[(0,r.jsx)(p.Z,{className:"h-4 w-4 text-destructive mt-0.5 flex-shrink-0",strokeWidth:1.5}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground leading-relaxed",children:"點數即將用完，建議儲值以繼續使用"})]})]}),(0,r.jsx)("button",{className:"w-full px-4 py-5 bg-primary hover:bg-primary-dark text-white rounded-xl transition-all shadow-sm active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed",onClick:()=>t.push("/send"),disabled:W&&(null!==(s=null==u?void 0:u.points)&&void 0!==s?s:0)<1,children:(0,r.jsxs)("div",{className:"flex items-center justify-center gap-3",children:[(0,r.jsx)(f.Z,{className:"h-6 w-6",strokeWidth:2}),(0,r.jsxs)("div",{className:"text-left",children:[(0,r.jsx)("div",{className:"text-lg font-medium",children:"發送提醒"}),(0,r.jsx)("div",{className:"text-xs opacity-80 mt-0.5",children:"一次性、不開啟聊天"})]})]})}),(null==u?void 0:u.userType)!=="pedestrian"&&C>0&&(0,r.jsx)(i.Zb,{className:"p-4 cursor-pointer hover:border-primary/50 transition-colors bg-primary/5 border-primary/30 shadow-none",onClick:()=>t.push("/inbox"),children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(b.Z,{className:"h-5 w-5 text-primary",strokeWidth:1.5}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-base font-medium text-foreground",children:"您有新的提醒"}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground mt-0.5",children:[C," 則未讀"]})]})]}),(0,r.jsx)("div",{className:"w-2.5 h-2.5 bg-primary rounded-full"})]})}),(null==u?void 0:u.userType)==="pedestrian"&&(0,r.jsx)(i.Zb,{className:"p-4 bg-muted/30 border-border shadow-none",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(c.Z,{className:"h-5 w-5 text-muted-foreground mt-0.5 flex-shrink-0",strokeWidth:1.5}),(0,r.jsxs)("div",{className:"text-sm space-y-1",children:[(0,r.jsx)("p",{className:"text-foreground font-medium",children:"行人用戶模式"}),(0,r.jsxs)("p",{className:"text-muted-foreground text-xs leading-relaxed",children:["你可以發送提醒給汽車/機車駕駛",(0,r.jsx)("br",{}),"但無法收到提醒（因為沒有車牌號碼）"]})]})]})}),(0,r.jsx)("div",{className:"px-4 py-3 bg-muted/30 rounded-lg border border-border",children:(0,r.jsxs)("p",{className:"text-xs text-muted-foreground leading-relaxed",children:["提醒送出後不會開啟聊天",(0,r.jsx)("br",{}),"所有提醒皆為一次性"]})}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,r.jsxs)(l.z,{variant:"outline",className:"h-20 flex-col gap-2 border-border hover:bg-muted/50 shadow-none relative",onClick:()=>t.push("/inbox"),children:[(0,r.jsx)(b.Z,{className:"h-5 w-5 text-muted-foreground",strokeWidth:1.5}),(0,r.jsx)("span",{className:"text-sm text-foreground",children:"收件箱"}),C>0&&(0,r.jsx)("div",{className:"absolute top-2 right-2 min-w-[20px] h-5 px-1.5 bg-primary rounded-full flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-xs text-primary-foreground font-medium tabular-nums",children:C>99?"99+":C})})]}),(0,r.jsxs)(l.z,{variant:"outline",className:"h-20 flex-col gap-2 border-border hover:bg-muted/50 shadow-none",onClick:()=>t.push("/sent"),children:[(0,r.jsx)(j,{className:"h-5 w-5 text-muted-foreground",strokeWidth:1.5}),(0,r.jsx)("span",{className:"text-sm text-foreground",children:"發送記錄"})]}),(0,r.jsxs)(l.z,{variant:"outline",className:"h-20 flex-col gap-2 border-border hover:bg-muted/50 shadow-none",onClick:()=>t.push("/wallet"),children:[(0,r.jsx)(h,{className:"h-5 w-5 text-muted-foreground",strokeWidth:1.5}),(0,r.jsx)("span",{className:"text-sm text-foreground",children:"點數"})]})]}),y.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"最近收到的提醒"}),(0,r.jsxs)("button",{className:"text-xs text-muted-foreground hover:text-foreground transition-colors flex items-center gap-0.5",onClick:()=>t.push("/inbox"),children:["查看全部",(0,r.jsx)(g.Z,{className:"h-3 w-3",strokeWidth:2})]})]}),(0,r.jsx)(i.Zb,{className:"divide-y divide-border bg-card border-border shadow-none overflow-hidden",children:y.slice(0,3).map(e=>(0,r.jsx)("button",{className:"w-full p-4 text-left hover:bg-muted/30 transition-colors ".concat(M(e.type)),onClick:()=>t.push("/inbox"),children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1.5",children:[(0,r.jsx)("span",{className:"text-xs px-2 py-0.5 rounded font-medium ".concat(P(e.type)),children:e.type}),!e.read&&(0,r.jsx)("div",{className:"w-2 h-2 bg-primary rounded-full"})]}),(0,r.jsx)("p",{className:"text-base text-foreground line-clamp-1 mb-1 font-medium",children:e.template}),e.customText&&(0,r.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-1",children:e.customText})]}),(0,r.jsx)(g.Z,{className:"h-4 w-4 text-muted-foreground flex-shrink-0 mt-1",strokeWidth:1.5})]})},e.id))})]})]}),(0,r.jsx)(v.Z,{})]})});y.displayName="HomePage";var w=y},2625:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(6576).Z)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},9198:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(6576).Z)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])}},function(e){e.O(0,[163,900,447,115,253,744],function(){return e(e.s=4465)}),_N_E=e.O()}]);